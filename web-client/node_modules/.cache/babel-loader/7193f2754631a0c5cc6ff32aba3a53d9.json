{"ast":null,"code":"import _defineProperty from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/home/aditya/Documents/github/bootcamp/ReactJS/web-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import Header from\"../../../component/header\";import{TextField,withStyles,CircularProgress}from\"@material-ui/core\";import{findStocksById,saveStock}from\"../../../action/stocks\";import{findAll as findItems}from\"../../../action/items\";import{findAll as findUnits}from\"../../../action/units\";import{connect}from\"react-redux\";import{Container}from\"semantic-ui-react\";import styles from\"./styles\";import Snackbar from\"@material-ui/core/Snackbar\";import Alert from\"@material-ui/lab/Alert\";import Autocomplete from\"@material-ui/lab/Autocomplete\";export var StockPage=/*#__PURE__*/function(_Component){_inherits(StockPage,_Component);var _super=_createSuper(StockPage);function StockPage(props){var _this;_classCallCheck(this,StockPage);_this=_super.call(this,props);_this.onBack=function(event){event.preventDefault();var history=_this.props.history;history.push(\"/stocks\");};_this.onChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;var form=_this.state.form;_this.setState({form:_objectSpread({},form,_defineProperty({},name,value))});};_this.onSubmit=function(event){event.preventDefault();_this.props.saveStock(_this.state.form);console.log(_this.state);};_this.onItemChange=function(event,value){var form=_this.state.form;_this.setState({form:_objectSpread({},form,{item:value})});};_this.onItemOpen=function(event){_this.props.findItems();};_this.onItemTextChange=function(event){var value=event.target.value;if(value){_this.props.findItems({search:{name:value}});}else{_this.setState({itemOptions:[]});}};_this.onUnitChange=function(event,value){var form=_this.state.form;_this.setState({form:_objectSpread({},form,{unit:value})});};_this.onUnitOpen=function(event){_this.props.findUnits();};_this.onUnitTextChange=function(event){var value=event.target.value;if(value){_this.props.findUnits({search:{name:value}});}else{_this.setState({unitOptions:[]});}};var match=_this.props.match;_this.state={form:{id:match.params.id,item:\"\",quantity:0,unit:\"\"},itemOptions:[],unitOptions:[],error:null};return _this;}_createClass(StockPage,[{key:\"componentDidMount\",value:function componentDidMount(){var form=this.state.form;if(form.id){this.props.findStocksById(form.id);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this$props=this.props,saveData=_this$props.saveData,data=_this$props.data,error=_this$props.error,saveError=_this$props.saveError,history=_this$props.history,itemsData=_this$props.itemsData;if(prevProps.itemsData!==itemsData){this.setState({itemOptions:itemsData===null||itemsData===void 0?void 0:itemsData.list});}else if(prevProps.data!=data){this.setState({form:data});}else if(prevProps.saveError!==saveError){this.setState({error:saveError});}else if(prevProps.error!==error){this.setState({error:error});}else if(saveData&&prevProps.saveData!==saveData){history.goBack();}}},{key:\"render\",value:function render(){var _this2=this;var _this$props2=this.props,classes=_this$props2.classes,loading=_this$props2.loading,saveError=_this$props2.saveError,itemsLoading=_this$props2.itemsLoading,itemsData=_this$props2.itemsData,unitsLoading=_this$props2.unitsLoading,unitsData=_this$props2.unitsData;var _this$state=this.state,form=_this$state.form,error=_this$state.error;var unitOptions=!unitsLoading&&unitsData?unitsData.list:[];var itemOptions=!itemsLoading&&itemsData?itemsData.list:[];var errorData=(saveError===null||saveError===void 0?void 0:saveError.data)||{};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,{error:error},/*#__PURE__*/React.createElement(Container,null,!loading?/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\",onSubmit:this.onSubmit},form.id&&/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(TextField,{id:\"id\",label:\"ID\",value:form.id,name:\"id\",variant:\"filled\",fullWidth:true,inputProps:{readOnly:true}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(Autocomplete,{id:\"combo-box-demo\",className:classes.select,fullWidth:true,autoHighlight:true,options:!itemsLoading?itemOptions:[],loading:itemsLoading,value:form.item,onOpen:this.onItemOpen,onChange:this.onItemChange,getOptionSelected:function getOptionSelected(option,value){return option.id==value.id;},getOptionLabel:function getOptionLabel(option){return option.name;},renderInput:function renderInput(params){return/*#__PURE__*/React.createElement(TextField,Object.assign({},params,{label:\"Item\",error:true,disabled:itemsLoading,variant:\"outlined\",onChange:_this2.onItemTextChange,inputProps:_objectSpread({},params.inputProps,{autoComplete:\"new-password\"})}));}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(TextField,{error:errorData.quantity,helperText:errorData.quantity?errorData.quantity[0]:null,id:\"quantity\",label:\"Quantity\",value:form.quantity,name:\"quantity\",variant:\"filled\",onChange:this.onChange,fullWidth:true})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(Autocomplete,{id:\"combo-box-demo\",className:classes.select,fullWidth:true,autoHighlight:true,options:!unitsLoading?unitOptions:[],loading:unitsLoading,value:form.unit,onOpen:this.onUnitOpen,onChange:this.onUnitChange,getOptionSelected:function getOptionSelected(option,value){return option.id==value.id;},getOptionLabel:function getOptionLabel(option){return option.name;},renderInput:function renderInput(params){return/*#__PURE__*/React.createElement(TextField,Object.assign({},params,{label:\"Unit\",disabled:unitsLoading,variant:\"outlined\",onChange:_this2.onUnitTextChange,inputProps:_objectSpread({},params.inputProps,{autoComplete:\"new-password\"})}));}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.buttonContainer},/*#__PURE__*/React.createElement(\"button\",{className:\"ui orange button\",onClick:this.onBack},/*#__PURE__*/React.createElement(\"i\",{class:\"reply all icon\"}),\"Back\"),/*#__PURE__*/React.createElement(\"button\",{className:\"ui orange button\",disabled:loading},/*#__PURE__*/React.createElement(\"i\",{className:\"save icon\"}),\"Save\"))):/*#__PURE__*/React.createElement(CircularProgress,null),/*#__PURE__*/React.createElement(Snackbar,{open:this.state.error,autoHideDuration:3000,onClose:function onClose(){return _this2.setState({error:false});}},/*#__PURE__*/React.createElement(Alert,{onClose:function onClose(){return _this2.setState({error:false});},elevation:6,variant:\"filled\",severity:\"error\"},error===null||error===void 0?void 0:error.message)))));}}]);return StockPage;}(Component);var mapStateToProps=function mapStateToProps(state){return{data:state.findStocksById.data,loading:state.findStocksById.loading||state.saveStock.loading,error:state.findStocksById.error,saveData:state.saveStock.data,saveError:state.saveStock.error,itemsData:state.findItems.data,itemsLoading:state.findItems.loading,itemsError:state.findItems.error,unitsData:state.findUnits.data,unitsLoading:state.findUnits.loading,unitsError:state.findUnits.error};};var mapDispatchToProps={findStocksById:findStocksById,saveStock:saveStock,findItems:findItems,findUnits:findUnits};export default withStyles(styles,{withTheme:true})(connect(mapStateToProps,mapDispatchToProps)(StockPage));","map":{"version":3,"sources":["/home/aditya/Documents/github/bootcamp/ReactJS/web-client/src/scenes/stock/detail/StockPage.js"],"names":["React","Component","Header","TextField","withStyles","CircularProgress","findStocksById","saveStock","findAll","findItems","findUnits","connect","Container","styles","Snackbar","Alert","Autocomplete","StockPage","props","onBack","event","preventDefault","history","push","onChange","target","name","value","form","state","setState","onSubmit","console","log","onItemChange","item","onItemOpen","onItemTextChange","search","itemOptions","onUnitChange","unit","onUnitOpen","onUnitTextChange","unitOptions","match","id","params","quantity","error","prevProps","prevState","saveData","data","saveError","itemsData","list","goBack","classes","loading","itemsLoading","unitsLoading","unitsData","errorData","formField","readOnly","select","option","inputProps","autoComplete","buttonContainer","message","mapStateToProps","itemsError","unitsError","mapDispatchToProps","withTheme"],"mappings":"ihCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,MAAP,KAAmB,2BAAnB,CACA,OAASC,SAAT,CAAoBC,UAApB,CAAgCC,gBAAhC,KAAwD,mBAAxD,CACA,OAASC,cAAT,CAAyBC,SAAzB,KAA0C,wBAA1C,CACA,OAASC,OAAO,GAAIC,CAAAA,SAApB,KAAqC,uBAArC,CACA,OAASD,OAAO,GAAIE,CAAAA,SAApB,KAAqC,uBAArC,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,SAAT,KAA0B,mBAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,4BAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,CACA,MAAOC,CAAAA,YAAP,KAAyB,+BAAzB,CAEA,UAAaC,CAAAA,SAAb,sGACE,mBAAYC,KAAZ,CAAmB,2CACjB,uBAAMA,KAAN,EADiB,MAgBnBC,MAhBmB,CAgBV,SAAAC,KAAK,CAAI,CAChBA,KAAK,CAACC,cAAN,GADgB,GAERC,CAAAA,OAFQ,CAEI,MAAKJ,KAFT,CAERI,OAFQ,CAGhBA,OAAO,CAACC,IAAR,CAAa,SAAb,EACD,CApBkB,OA6CnBC,QA7CmB,CA6CR,SAAAJ,KAAK,CAAI,mBACMA,KAAK,CAACK,MADZ,CACVC,IADU,eACVA,IADU,CACJC,KADI,eACJA,KADI,IAEVC,CAAAA,IAFU,CAED,MAAKC,KAFJ,CAEVD,IAFU,CAGlB,MAAKE,QAAL,CAAc,CAAEF,IAAI,kBAAOA,IAAP,oBAAcF,IAAd,CAAqBC,KAArB,EAAN,CAAd,EACD,CAjDkB,OAmDnBI,QAnDmB,CAmDR,SAAAX,KAAK,CAAI,CAClBA,KAAK,CAACC,cAAN,GACA,MAAKH,KAAL,CAAWX,SAAX,CAAqB,MAAKsB,KAAL,CAAWD,IAAhC,EACAI,OAAO,CAACC,GAAR,CAAY,MAAKJ,KAAjB,EACD,CAvDkB,OAyDnBK,YAzDmB,CAyDJ,SAACd,KAAD,CAAQO,KAAR,CAAkB,IACvBC,CAAAA,IADuB,CACd,MAAKC,KADS,CACvBD,IADuB,CAE/B,MAAKE,QAAL,CAAc,CAAEF,IAAI,kBAAOA,IAAP,EAAaO,IAAI,CAAER,KAAnB,EAAN,CAAd,EACD,CA5DkB,OA8DnBS,UA9DmB,CA8DN,SAAAhB,KAAK,CAAI,CACpB,MAAKF,KAAL,CAAWT,SAAX,GACD,CAhEkB,OAkEnB4B,gBAlEmB,CAkEA,SAAAjB,KAAK,CAAI,IAClBO,CAAAA,KADkB,CACRP,KAAK,CAACK,MADE,CAClBE,KADkB,CAE1B,GAAIA,KAAJ,CAAW,CACT,MAAKT,KAAL,CAAWT,SAAX,CAAqB,CAAE6B,MAAM,CAAE,CAAEZ,IAAI,CAAEC,KAAR,CAAV,CAArB,EACD,CAFD,IAEO,CACL,MAAKG,QAAL,CAAc,CAAES,WAAW,CAAE,EAAf,CAAd,EACD,CACF,CAzEkB,OA2EnBC,YA3EmB,CA2EJ,SAACpB,KAAD,CAAQO,KAAR,CAAkB,IACvBC,CAAAA,IADuB,CACd,MAAKC,KADS,CACvBD,IADuB,CAE/B,MAAKE,QAAL,CAAc,CAAEF,IAAI,kBAAOA,IAAP,EAAaa,IAAI,CAAEd,KAAnB,EAAN,CAAd,EACD,CA9EkB,OAgFnBe,UAhFmB,CAgFN,SAAAtB,KAAK,CAAI,CACpB,MAAKF,KAAL,CAAWR,SAAX,GACD,CAlFkB,OAoFnBiC,gBApFmB,CAoFA,SAAAvB,KAAK,CAAI,IAClBO,CAAAA,KADkB,CACRP,KAAK,CAACK,MADE,CAClBE,KADkB,CAE1B,GAAIA,KAAJ,CAAW,CACT,MAAKT,KAAL,CAAWR,SAAX,CAAqB,CAAE4B,MAAM,CAAE,CAAEZ,IAAI,CAAEC,KAAR,CAAV,CAArB,EACD,CAFD,IAEO,CACL,MAAKG,QAAL,CAAc,CAAEc,WAAW,CAAE,EAAf,CAAd,EACD,CACF,CA3FkB,IAETC,CAAAA,KAFS,CAEC,MAAK3B,KAFN,CAET2B,KAFS,CAGjB,MAAKhB,KAAL,CAAa,CACXD,IAAI,CAAE,CACJkB,EAAE,CAAED,KAAK,CAACE,MAAN,CAAaD,EADb,CAEJX,IAAI,CAAE,EAFF,CAGJa,QAAQ,CAAE,CAHN,CAIJP,IAAI,CAAE,EAJF,CADK,CAOXF,WAAW,CAAE,EAPF,CAQXK,WAAW,CAAE,EARF,CASXK,KAAK,CAAE,IATI,CAAb,CAHiB,aAclB,CAfH,mFAuBsB,IACVrB,CAAAA,IADU,CACD,KAAKC,KADJ,CACVD,IADU,CAElB,GAAIA,IAAI,CAACkB,EAAT,CAAa,CACX,KAAK5B,KAAL,CAAWZ,cAAX,CAA0BsB,IAAI,CAACkB,EAA/B,EACD,CACF,CA5BH,8DA8BqBI,SA9BrB,CA8BgCC,SA9BhC,CA8B2C,iBAC0B,KAAKjC,KAD/B,CAC/BkC,QAD+B,aAC/BA,QAD+B,CACrBC,IADqB,aACrBA,IADqB,CACfJ,KADe,aACfA,KADe,CACRK,SADQ,aACRA,SADQ,CACGhC,OADH,aACGA,OADH,CACYiC,SADZ,aACYA,SADZ,CAGvC,GAAIL,SAAS,CAACK,SAAV,GAAwBA,SAA5B,CAAuC,CACrC,KAAKzB,QAAL,CAAc,CAAES,WAAW,CAAEgB,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAEC,IAA1B,CAAd,EACD,CAFD,IAEO,IAAIN,SAAS,CAACG,IAAV,EAAkBA,IAAtB,CAA4B,CACjC,KAAKvB,QAAL,CAAc,CAAEF,IAAI,CAAEyB,IAAR,CAAd,EACD,CAFM,IAEA,IAAIH,SAAS,CAACI,SAAV,GAAwBA,SAA5B,CAAuC,CAC5C,KAAKxB,QAAL,CAAc,CAAEmB,KAAK,CAAEK,SAAT,CAAd,EACD,CAFM,IAEA,IAAIJ,SAAS,CAACD,KAAV,GAAoBA,KAAxB,CAA+B,CACpC,KAAKnB,QAAL,CAAc,CAAEmB,KAAK,CAAEA,KAAT,CAAd,EACD,CAFM,IAEA,IAAIG,QAAQ,EAAIF,SAAS,CAACE,QAAV,GAAuBA,QAAvC,CAAiD,CACtD9B,OAAO,CAACmC,MAAR,GACD,CACF,CA5CH,uCA8FW,kCASH,KAAKvC,KATF,CAELwC,OAFK,cAELA,OAFK,CAGLC,OAHK,cAGLA,OAHK,CAILL,SAJK,cAILA,SAJK,CAKLM,YALK,cAKLA,YALK,CAMLL,SANK,cAMLA,SANK,CAOLM,YAPK,cAOLA,YAPK,CAQLC,SARK,cAQLA,SARK,iBAUiB,KAAKjC,KAVtB,CAUCD,IAVD,aAUCA,IAVD,CAUOqB,KAVP,aAUOA,KAVP,CAWP,GAAML,CAAAA,WAAW,CAAG,CAACiB,YAAD,EAAiBC,SAAjB,CAA6BA,SAAS,CAACN,IAAvC,CAA8C,EAAlE,CACA,GAAMjB,CAAAA,WAAW,CAAG,CAACqB,YAAD,EAAiBL,SAAjB,CAA6BA,SAAS,CAACC,IAAvC,CAA8C,EAAlE,CACA,GAAMO,CAAAA,SAAS,CAAG,CAAAT,SAAS,OAAT,EAAAA,SAAS,SAAT,QAAAA,SAAS,CAAED,IAAX,GAAmB,EAArC,CACA,mBACE,4CACE,oBAAC,MAAD,EAAQ,KAAK,CAAEJ,KAAf,eACE,oBAAC,SAAD,MACG,CAACU,OAAD,cACC,4BAAM,YAAY,CAAC,KAAnB,CAAyB,QAAQ,CAAE,KAAK5B,QAAxC,EACGH,IAAI,CAACkB,EAAL,eACC,2BAAK,SAAS,CAAEY,OAAO,CAACM,SAAxB,eACE,oBAAC,SAAD,EACE,EAAE,CAAC,IADL,CAEE,KAAK,CAAC,IAFR,CAGE,KAAK,CAAEpC,IAAI,CAACkB,EAHd,CAIE,IAAI,CAAC,IAJP,CAKE,OAAO,CAAC,QALV,CAME,SAAS,KANX,CAOE,UAAU,CAAE,CAAEmB,QAAQ,CAAE,IAAZ,CAPd,EADF,CAFJ,cAcE,2BAAK,SAAS,CAAEP,OAAO,CAACM,SAAxB,eACE,oBAAC,YAAD,EACE,EAAE,CAAC,gBADL,CAEE,SAAS,CAAEN,OAAO,CAACQ,MAFrB,CAGE,SAAS,KAHX,CAIE,aAAa,KAJf,CAKE,OAAO,CAAE,CAACN,YAAD,CAAgBrB,WAAhB,CAA8B,EALzC,CAME,OAAO,CAAEqB,YANX,CAOE,KAAK,CAAEhC,IAAI,CAACO,IAPd,CAQE,MAAM,CAAE,KAAKC,UARf,CASE,QAAQ,CAAE,KAAKF,YATjB,CAUE,iBAAiB,CAAE,2BAACiC,MAAD,CAASxC,KAAT,QAAmBwC,CAAAA,MAAM,CAACrB,EAAP,EAAanB,KAAK,CAACmB,EAAtC,EAVrB,CAWE,cAAc,CAAE,wBAAAqB,MAAM,QAAIA,CAAAA,MAAM,CAACzC,IAAX,EAXxB,CAYE,WAAW,CAAE,qBAAAqB,MAAM,qBACjB,oBAAC,SAAD,kBACMA,MADN,EAEE,KAAK,CAAC,MAFR,CAGE,KAAK,CAAE,IAHT,CAIE,QAAQ,CAAEa,YAJZ,CAKE,OAAO,CAAC,UALV,CAME,QAAQ,CAAE,MAAI,CAACvB,gBANjB,CAOE,UAAU,kBACLU,MAAM,CAACqB,UADF,EAERC,YAAY,CAAE,cAFN,EAPZ,GADiB,EAZrB,EADF,CAdF,cA2CE,2BAAK,SAAS,CAAEX,OAAO,CAACM,SAAxB,eACE,oBAAC,SAAD,EACE,KAAK,CAAED,SAAS,CAACf,QADnB,CAEE,UAAU,CACRe,SAAS,CAACf,QAAV,CAAqBe,SAAS,CAACf,QAAV,CAAmB,CAAnB,CAArB,CAA6C,IAHjD,CAKE,EAAE,CAAC,UALL,CAME,KAAK,CAAC,UANR,CAOE,KAAK,CAAEpB,IAAI,CAACoB,QAPd,CAQE,IAAI,CAAC,UARP,CASE,OAAO,CAAC,QATV,CAUE,QAAQ,CAAE,KAAKxB,QAVjB,CAWE,SAAS,KAXX,EADF,CA3CF,cA0DE,2BAAK,SAAS,CAAEkC,OAAO,CAACM,SAAxB,eACE,oBAAC,YAAD,EACE,EAAE,CAAC,gBADL,CAEE,SAAS,CAAEN,OAAO,CAACQ,MAFrB,CAGE,SAAS,KAHX,CAIE,aAAa,KAJf,CAKE,OAAO,CAAE,CAACL,YAAD,CAAgBjB,WAAhB,CAA8B,EALzC,CAME,OAAO,CAAEiB,YANX,CAOE,KAAK,CAAEjC,IAAI,CAACa,IAPd,CAQE,MAAM,CAAE,KAAKC,UARf,CASE,QAAQ,CAAE,KAAKF,YATjB,CAUE,iBAAiB,CAAE,2BAAC2B,MAAD,CAASxC,KAAT,QAAmBwC,CAAAA,MAAM,CAACrB,EAAP,EAAanB,KAAK,CAACmB,EAAtC,EAVrB,CAWE,cAAc,CAAE,wBAAAqB,MAAM,QAAIA,CAAAA,MAAM,CAACzC,IAAX,EAXxB,CAYE,WAAW,CAAE,qBAAAqB,MAAM,qBACjB,oBAAC,SAAD,kBACMA,MADN,EAEE,KAAK,CAAC,MAFR,CAGE,QAAQ,CAAEc,YAHZ,CAIE,OAAO,CAAC,UAJV,CAKE,QAAQ,CAAE,MAAI,CAAClB,gBALjB,CAME,UAAU,kBACLI,MAAM,CAACqB,UADF,EAERC,YAAY,CAAE,cAFN,EANZ,GADiB,EAZrB,EADF,CA1DF,cAsFE,2BAAK,SAAS,CAAEX,OAAO,CAACY,eAAxB,eACE,8BAAQ,SAAS,CAAC,kBAAlB,CAAqC,OAAO,CAAE,KAAKnD,MAAnD,eACE,yBAAG,KAAK,CAAC,gBAAT,EADF,QADF,cAKE,8BAAQ,SAAS,CAAC,kBAAlB,CAAqC,QAAQ,CAAEwC,OAA/C,eACE,yBAAG,SAAS,CAAC,WAAb,EADF,QALF,CAtFF,CADD,cAmGC,oBAAC,gBAAD,MApGJ,cAsGE,oBAAC,QAAD,EACE,IAAI,CAAE,KAAK9B,KAAL,CAAWoB,KADnB,CAEE,gBAAgB,CAAE,IAFpB,CAGE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACnB,QAAL,CAAc,CAAEmB,KAAK,CAAE,KAAT,CAAd,CAAN,EAHX,eAKE,oBAAC,KAAD,EACE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACnB,QAAL,CAAc,CAAEmB,KAAK,CAAE,KAAT,CAAd,CAAN,EADX,CAEE,SAAS,CAAE,CAFb,CAGE,OAAO,CAAC,QAHV,CAIE,QAAQ,CAAC,OAJX,EAMGA,KANH,SAMGA,KANH,iBAMGA,KAAK,CAAEsB,OANV,CALF,CAtGF,CADF,CADF,CADF,CA2HD,CAvOH,uBAA+BtE,SAA/B,EA0OA,GAAMuE,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAA3C,KAAK,QAAK,CAChCwB,IAAI,CAAExB,KAAK,CAACvB,cAAN,CAAqB+C,IADK,CAEhCM,OAAO,CAAE9B,KAAK,CAACvB,cAAN,CAAqBqD,OAArB,EAAgC9B,KAAK,CAACtB,SAAN,CAAgBoD,OAFzB,CAGhCV,KAAK,CAAEpB,KAAK,CAACvB,cAAN,CAAqB2C,KAHI,CAIhCG,QAAQ,CAAEvB,KAAK,CAACtB,SAAN,CAAgB8C,IAJM,CAKhCC,SAAS,CAAEzB,KAAK,CAACtB,SAAN,CAAgB0C,KALK,CAMhCM,SAAS,CAAE1B,KAAK,CAACpB,SAAN,CAAgB4C,IANK,CAOhCO,YAAY,CAAE/B,KAAK,CAACpB,SAAN,CAAgBkD,OAPE,CAQhCc,UAAU,CAAE5C,KAAK,CAACpB,SAAN,CAAgBwC,KARI,CAShCa,SAAS,CAAEjC,KAAK,CAACnB,SAAN,CAAgB2C,IATK,CAUhCQ,YAAY,CAAEhC,KAAK,CAACnB,SAAN,CAAgBiD,OAVE,CAWhCe,UAAU,CAAE7C,KAAK,CAACnB,SAAN,CAAgBuC,KAXI,CAAL,EAA7B,CAcA,GAAM0B,CAAAA,kBAAkB,CAAG,CACzBrE,cAAc,CAAdA,cADyB,CAEzBC,SAAS,CAATA,SAFyB,CAGzBE,SAAS,CAATA,SAHyB,CAIzBC,SAAS,CAATA,SAJyB,CAA3B,CAOA,cAAeN,CAAAA,UAAU,CAACS,MAAD,CAAS,CAAE+D,SAAS,CAAE,IAAb,CAAT,CAAV,CACbjE,OAAO,CAAC6D,eAAD,CAAkBG,kBAAlB,CAAP,CAA6C1D,SAA7C,CADa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport Header from \"../../../component/header\";\nimport { TextField, withStyles, CircularProgress } from \"@material-ui/core\";\nimport { findStocksById, saveStock } from \"../../../action/stocks\";\nimport { findAll as findItems } from \"../../../action/items\";\nimport { findAll as findUnits } from \"../../../action/units\";\nimport { connect } from \"react-redux\";\nimport { Container } from \"semantic-ui-react\";\nimport styles from \"./styles\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\n\nexport class StockPage extends Component {\n  constructor(props) {\n    super(props);\n    const { match } = this.props;\n    this.state = {\n      form: {\n        id: match.params.id,\n        item: \"\",\n        quantity: 0,\n        unit: \"\"\n      },\n      itemOptions: [],\n      unitOptions: [],\n      error: null\n    };\n  }\n\n  onBack = event => {\n    event.preventDefault();\n    const { history } = this.props;\n    history.push(\"/stocks\");\n  };\n\n  componentDidMount() {\n    const { form } = this.state;\n    if (form.id) {\n      this.props.findStocksById(form.id);\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { saveData, data, error, saveError, history, itemsData } = this.props;\n\n    if (prevProps.itemsData !== itemsData) {\n      this.setState({ itemOptions: itemsData?.list });\n    } else if (prevProps.data != data) {\n      this.setState({ form: data });\n    } else if (prevProps.saveError !== saveError) {\n      this.setState({ error: saveError });\n    } else if (prevProps.error !== error) {\n      this.setState({ error: error });\n    } else if (saveData && prevProps.saveData !== saveData) {\n      history.goBack();\n    }\n  }\n\n  onChange = event => {\n    const { name, value } = event.target;\n    const { form } = this.state;\n    this.setState({ form: { ...form, [name]: value } });\n  };\n\n  onSubmit = event => {\n    event.preventDefault();\n    this.props.saveStock(this.state.form);\n    console.log(this.state);\n  };\n\n  onItemChange = (event, value) => {\n    const { form } = this.state;\n    this.setState({ form: { ...form, item: value } });\n  };\n\n  onItemOpen = event => {\n    this.props.findItems();\n  };\n\n  onItemTextChange = event => {\n    const { value } = event.target;\n    if (value) {\n      this.props.findItems({ search: { name: value } });\n    } else {\n      this.setState({ itemOptions: [] });\n    }\n  };\n\n  onUnitChange = (event, value) => {\n    const { form } = this.state;\n    this.setState({ form: { ...form, unit: value } });\n  };\n\n  onUnitOpen = event => {\n    this.props.findUnits();\n  };\n\n  onUnitTextChange = event => {\n    const { value } = event.target;\n    if (value) {\n      this.props.findUnits({ search: { name: value } });\n    } else {\n      this.setState({ unitOptions: [] });\n    }\n  };\n\n  render() {\n    const {\n      classes,\n      loading,\n      saveError,\n      itemsLoading,\n      itemsData,\n      unitsLoading,\n      unitsData\n    } = this.props;\n    const { form, error } = this.state;\n    const unitOptions = !unitsLoading && unitsData ? unitsData.list : [];\n    const itemOptions = !itemsLoading && itemsData ? itemsData.list : [];\n    const errorData = saveError?.data || {};\n    return (\n      <div>\n        <Header error={error}>\n          <Container>\n            {!loading ? (\n              <form autoComplete=\"off\" onSubmit={this.onSubmit}>\n                {form.id && (\n                  <div className={classes.formField}>\n                    <TextField\n                      id=\"id\"\n                      label=\"ID\"\n                      value={form.id}\n                      name=\"id\"\n                      variant=\"filled\"\n                      fullWidth\n                      inputProps={{ readOnly: true }}\n                    />\n                  </div>\n                )}\n                <div className={classes.formField}>\n                  <Autocomplete\n                    id=\"combo-box-demo\"\n                    className={classes.select}\n                    fullWidth\n                    autoHighlight\n                    options={!itemsLoading ? itemOptions : []}\n                    loading={itemsLoading}\n                    value={form.item}\n                    onOpen={this.onItemOpen}\n                    onChange={this.onItemChange}\n                    getOptionSelected={(option, value) => option.id == value.id}\n                    getOptionLabel={option => option.name}\n                    renderInput={params => (\n                      <TextField\n                        {...params}\n                        label=\"Item\"\n                        error={true}\n                        disabled={itemsLoading}\n                        variant=\"outlined\"\n                        onChange={this.onItemTextChange}\n                        inputProps={{\n                          ...params.inputProps,\n                          autoComplete: \"new-password\"\n                        }}\n                      />\n                    )}\n                  />\n                </div>\n                <div className={classes.formField}>\n                  <TextField\n                    error={errorData.quantity}\n                    helperText={\n                      errorData.quantity ? errorData.quantity[0] : null\n                    }\n                    id=\"quantity\"\n                    label=\"Quantity\"\n                    value={form.quantity}\n                    name=\"quantity\"\n                    variant=\"filled\"\n                    onChange={this.onChange}\n                    fullWidth\n                  />\n                </div>\n                <div className={classes.formField}>\n                  <Autocomplete\n                    id=\"combo-box-demo\"\n                    className={classes.select}\n                    fullWidth\n                    autoHighlight\n                    options={!unitsLoading ? unitOptions : []}\n                    loading={unitsLoading}\n                    value={form.unit}\n                    onOpen={this.onUnitOpen}\n                    onChange={this.onUnitChange}\n                    getOptionSelected={(option, value) => option.id == value.id}\n                    getOptionLabel={option => option.name}\n                    renderInput={params => (\n                      <TextField\n                        {...params}\n                        label=\"Unit\"\n                        disabled={unitsLoading}\n                        variant=\"outlined\"\n                        onChange={this.onUnitTextChange}\n                        inputProps={{\n                          ...params.inputProps,\n                          autoComplete: \"new-password\"\n                        }}\n                      />\n                    )}\n                  />\n                </div>\n                <div className={classes.buttonContainer}>\n                  <button className=\"ui orange button\" onClick={this.onBack}>\n                    <i class=\"reply all icon\"></i>\n                    Back\n                  </button>\n                  <button className=\"ui orange button\" disabled={loading}>\n                    <i className=\"save icon\"></i>\n                    Save\n                  </button>\n                </div>\n              </form>\n            ) : (\n              <CircularProgress />\n            )}\n            <Snackbar\n              open={this.state.error}\n              autoHideDuration={3000}\n              onClose={() => this.setState({ error: false })}\n            >\n              <Alert\n                onClose={() => this.setState({ error: false })}\n                elevation={6}\n                variant=\"filled\"\n                severity=\"error\"\n              >\n                {error?.message}\n              </Alert>\n            </Snackbar>\n          </Container>\n        </Header>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  data: state.findStocksById.data,\n  loading: state.findStocksById.loading || state.saveStock.loading,\n  error: state.findStocksById.error,\n  saveData: state.saveStock.data,\n  saveError: state.saveStock.error,\n  itemsData: state.findItems.data,\n  itemsLoading: state.findItems.loading,\n  itemsError: state.findItems.error,\n  unitsData: state.findUnits.data,\n  unitsLoading: state.findUnits.loading,\n  unitsError: state.findUnits.error\n});\n\nconst mapDispatchToProps = {\n  findStocksById,\n  saveStock,\n  findItems,\n  findUnits\n};\n\nexport default withStyles(styles, { withTheme: true })(\n  connect(mapStateToProps, mapDispatchToProps)(StockPage)\n);\n"]},"metadata":{},"sourceType":"module"}